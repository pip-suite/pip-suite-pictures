!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;((e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).pip||(e.pip={})).pictures=t()}}(function(){return function o(l,a,c){function u(e,t){if(!a[e]){if(!l[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(s)return s(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var n=a[e]={exports:{}};l[e][0].call(n.exports,function(t){return u(l[e][1][t]||t)},n,n.exports,o,l,a,c)}return a[e].exports}for(var s="function"==typeof require&&require,t=0;t<c.length;t++)u(c[t]);return u}({1:[function(t,V,e){(function(j,M,H){!function(){var t,m={};function v(){}function c(t){return t}function e(t){return!!t}function i(t){return!t}var r="object"==typeof self&&self.self===self&&self||"object"==typeof M&&M.global===M&&M||this;function s(t){return function(){if(null===t)throw new Error("Callback was already called.");t.apply(this,arguments),t=null}}function P(t){return function(){null!==t&&(t.apply(this,arguments),t=null)}}null!=r&&(t=r.async),m.noConflict=function(){return r.async=t,m};var n=Object.prototype.toString,y=Array.isArray||function(t){return"[object Array]"===n.call(t)};function l(t){return y(t)||"number"==typeof t.length&&0<=t.length&&t.length%1==0}function b(t,e){for(var i=-1,r=t.length;++i<r;)e(t[i],i,t)}function u(t,e){for(var i=-1,r=t.length,n=Array(r);++i<r;)n[i]=e(t[i],i,t);return n}function o(t){return u(Array(t),function(t,e){return e})}function $(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1}var I=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e};function p(t){var e,i,r=-1;return l(t)?(e=t.length,function(){return++r<e?r:null}):(i=I(t),e=i.length,function(){return++r<e?i[r]:null})}function _(r,n){return n=null==n?r.length-1:+n,function(){for(var t=Math.max(arguments.length-n,0),e=Array(t),i=0;i<t;i++)e[i]=arguments[i+n];switch(n){case 0:return r.call(this,e);case 1:return r.call(this,arguments[0],e)}}}function a(r){return function(t,e,i){return r(t,i)}}var d="function"==typeof H&&H,h=d?function(t){d(t)}:function(t){setTimeout(t,0)};function f(u){return function(i,r,n){n=P(n||v);var o=p(i=i||[]);if(u<=0)return n(null);var l=!1,a=0,c=!1;!function e(){if(l&&a<=0)return n(null);for(;a<u&&!c;){var t=o();if(null===t)return l=!0,void(a<=0&&n(null));a+=1,r(i[t],t,s(function(t){--a,t?(n(t),c=!0):e()}))}}()}}function g(r){return function(t,e,i){return r(m.eachOf,t,e,i)}}function C(n){return function(t,e,i,r){return n(f(e),t,i,r)}}function R(r){return function(t,e,i){return r(m.eachOfSeries,t,e,i)}}function x(t,e,n,i){i=P(i||v);var o=l(e=e||[])?[]:{};t(e,function(t,i,r){n(t,function(t,e){o[i]=e,r(t)})},function(t){i(t,o)})}function D(t,e,n,i){var o=[];t(e,function(e,i,r){n(e,function(t){t&&o.push({index:i,value:e}),r()})},function(){i(u(o.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})}function E(t,e,i,r){D(t,e,function(t,e){i(t,function(t){e(!t)})},r)}function S(l,a,c){return function(t,e,r,n){function i(){n&&n(c(!1,void 0))}function o(e,t,i){if(!n)return i();r(e,function(t){n&&a(t)&&(n(c(!0,e)),n=r=!1),i()})}3<arguments.length?l(t,e,o,i):(n=r,r=e,l(t,o,i))}}function w(t,e){return e}function A(t,e,i){i=i||v;var n=l(e)?[]:{};t(e,function(t,i,r){t(_(function(t,e){e.length<=1&&(e=e[0]),n[i]=e,r(t)}))},function(t){i(t,n)})}function O(t,e,r,i){var n=[];t(e,function(t,e,i){r(t,function(t,e){n=n.concat(e||[]),i(t)})},function(t){i(t,n)})}function T(r,t,e){if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");function i(i,t,r,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(i.started=!0,y(t)||(t=[t]),0===t.length&&i.idle())return m.setImmediate(function(){i.drain()});b(t,function(t){var e={data:t,callback:n||v};r?i.tasks.unshift(e):i.tasks.push(e),i.tasks.length===i.concurrency&&i.saturated()}),m.setImmediate(i.process)}function n(e,i){return function(){--o;var r=!1,t=arguments;b(i,function(i){b(l,function(t,e){t!==i||r||(l.splice(e,1),r=!0)}),i.callback.apply(i,t)}),e.tasks.length+o===0&&e.drain(),e.process()}}var o=0,l=[],a={tasks:[],concurrency:t,payload:e,saturated:v,empty:v,drain:v,started:!1,paused:!1,push:function(t,e){i(a,t,!1,e)},kill:function(){a.drain=v,a.tasks=[]},unshift:function(t,e){i(a,t,!0,e)},process:function(){for(;!a.paused&&o<a.concurrency&&a.tasks.length;){var t=a.payload?a.tasks.splice(0,a.payload):a.tasks.splice(0,a.tasks.length),e=u(t,function(t){return t.data});0===a.tasks.length&&a.empty(),o+=1,l.push(t[0]);var i=s(n(a,t));r(e,i)}},length:function(){return a.tasks.length},running:function(){return o},workersList:function(){return l},idle:function(){return a.tasks.length+o===0},pause:function(){a.paused=!0},resume:function(){if(!1!==a.paused){a.paused=!1;for(var t=Math.min(a.concurrency,a.tasks.length),e=1;e<=t;e++)m.setImmediate(a.process)}}};return a}function k(i){return _(function(t,e){t.apply(null,e.concat([_(function(t,e){"object"==typeof console&&(t?console.error&&console.error(t):console[i]&&b(e,function(t){console[i](t)}))})]))})}function U(r){return function(t,e,i){r(o(t),e,i)}}function L(o){return _(function(e,t){var i=_(function(r){var n=this,t=r.pop();return o(e,function(t,e,i){t.apply(n,r.concat([i]))},t)});return t.length?i.apply(this,t):i})}function W(r){return _(function(t){var e=t.pop();t.push(function(){var t=arguments;i?m.setImmediate(function(){e.apply(null,t)}):e.apply(null,t)});var i=!0;r.apply(this,t),i=!1})}"object"==typeof j&&"function"==typeof j.nextTick?m.nextTick=j.nextTick:m.nextTick=h,m.setImmediate=d?h:m.nextTick,m.forEach=m.each=function(t,e,i){return m.eachOf(t,a(e),i)},m.forEachSeries=m.eachSeries=function(t,e,i){return m.eachOfSeries(t,a(e),i)},m.forEachLimit=m.eachLimit=function(t,e,i,r){return f(e)(t,a(i),r)},m.forEachOf=m.eachOf=function(t,e,i){i=P(i||v);for(var r,n=p(t=t||[]),o=0;null!=(r=n());)o+=1,e(t[r],r,s(l));function l(t){o--,t?i(t):null===r&&o<=0&&i(null)}0===o&&i(null)},m.forEachOfSeries=m.eachOfSeries=function(t,r,n){n=P(n||v);var o=p(t=t||[]),l=o();!function e(){var i=!0;if(null===l)return n(null);r(t[l],l,s(function(t){if(t)n(t);else{if(null===(l=o()))return n(null);i?m.setImmediate(e):e()}})),i=!1}()},m.forEachOfLimit=m.eachOfLimit=function(t,e,i,r){f(e)(t,i,r)},m.map=g(x),m.mapSeries=R(x),m.mapLimit=C(x),m.inject=m.foldl=m.reduce=function(t,r,n,e){m.eachOfSeries(t,function(t,e,i){n(r,t,function(t,e){r=e,i(t)})},function(t){e(t,r)})},m.foldr=m.reduceRight=function(t,e,i,r){var n=u(t,c).reverse();m.reduce(n,e,i,r)},m.transform=function(t,r,n,e){3===arguments.length&&(e=n,n=r,r=y(t)?[]:{}),m.eachOf(t,function(t,e,i){n(r,t,e,i)},function(t){e(t,r)})},m.select=m.filter=g(D),m.selectLimit=m.filterLimit=C(D),m.selectSeries=m.filterSeries=R(D),m.reject=g(E),m.rejectLimit=C(E),m.rejectSeries=R(E),m.any=m.some=S(m.eachOf,e,c),m.someLimit=S(m.eachOfLimit,e,c),m.all=m.every=S(m.eachOf,i,i),m.everyLimit=S(m.eachOfLimit,i,i),m.detect=S(m.eachOf,c,w),m.detectSeries=S(m.eachOfSeries,c,w),m.detectLimit=S(m.eachOfLimit,c,w),m.sortBy=function(t,e,i){function r(t,e){var i=t.criteria,r=e.criteria;return i<r?-1:r<i?1:0}m.map(t,function(i,r){e(i,function(t,e){t?r(t):r(null,{value:i,criteria:e})})},function(t,e){if(t)return i(t);i(null,u(e.sort(r),function(t){return t.value}))})},m.auto=function(a,c,u){"function"==typeof c&&(u=c,c=null),u=P(u||v);var t=I(a),e=t.length;if(!e)return u(null);c=c||e;var s={},p=0,d=!1,h=[];function f(t){h.unshift(t)}function g(){e--,b(h.slice(0),function(t){t()})}f(function(){e||u(null,s)}),b(t,function(o){if(!d){for(var t,i=y(a[o])?a[o]:[a[o]],r=_(function(t,e){if(p--,e.length<=1&&(e=e[0]),t){var i={};n=function(t,e){i[e]=t},b(I(r=s),function(t){n(r[t],t)}),i[o]=e,d=!0,u(t,i)}else s[o]=e,m.setImmediate(g);var r,n}),e=i.slice(0,i.length-1),n=e.length;n--;){if(!(t=a[e[n]]))throw new Error("Has nonexistent dependency in "+e.join(", "));if(y(t)&&0<=$(t,o))throw new Error("Has cyclic dependencies")}l()?(p++,i[i.length-1](r,s)):f(function t(){l()&&(p++,0<=(e=$(h,t))&&h.splice(e,1),i[i.length-1](r,s));var e})}function l(){return p<c&&(r=function(t,e){return t&&s.hasOwnProperty(e)},n=!0,b(e,function(t,e,i){n=r(n,t,e,i)}),n)&&!s.hasOwnProperty(o);var r,n}})},m.retry=function(t,e,i){var o=[],l={times:5,interval:0};var r=arguments.length;if(r<1||3<r)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");function n(i,e){function t(t,r){return function(i){t(function(t,e){i(!t||r,{err:t,result:e})},e)}}function r(e){return function(t){setTimeout(function(){t(null)},e)}}for(;l.times;){var n=!--l.times;o.push(t(l.task,n)),!n&&0<l.interval&&o.push(r(l.interval))}m.series(o,function(t,e){e=e[e.length-1],(i||l.callback)(e.err,e.result)})}return r<=2&&"function"==typeof t&&(i=e,e=t),"function"!=typeof t&&function(t,e){if("number"==typeof e)t.times=parseInt(e,10)||5;else{if("object"!=typeof e)throw new Error("Unsupported argument type for 'times': "+typeof e);t.times=parseInt(e.times,10)||5,t.interval=parseInt(e.interval,10)||0}}(l,t),l.callback=i,l.task=e,l.callback?n():n},m.waterfall=function(t,o){if(o=P(o||v),!y(t)){var e=new Error("First argument to waterfall must be an array of functions");return o(e)}if(!t.length)return o();!function r(n){return _(function(t,e){if(t)o.apply(null,[t].concat(e));else{var i=n.next();i?e.push(r(i)):e.push(o),W(n).apply(null,e)}})}(m.iterator(t))()},m.parallel=function(t,e){A(m.eachOf,t,e)},m.parallelLimit=function(t,e,i){A(f(e),t,i)},m.series=function(t,e){A(m.eachOfSeries,t,e)},m.iterator=function(r){return function t(e){function i(){return r.length&&r[e].apply(null,arguments),i.next()}return i.next=function(){return e<r.length-1?t(e+1):null},i}(0)},m.apply=_(function(e,i){return _(function(t){return e.apply(null,i.concat(t))})}),m.concat=g(O),m.concatSeries=R(O),m.whilst=function(i,r,n){if(n=n||v,i()){var o=_(function(t,e){t?n(t):i.apply(this,e)?r(o):n.apply(null,[null].concat(e))});r(o)}else n(null)},m.doWhilst=function(t,e,i){var r=0;return m.whilst(function(){return++r<=1||e.apply(this,arguments)},t,i)},m.until=function(t,e,i){return m.whilst(function(){return!t.apply(this,arguments)},e,i)},m.doUntil=function(t,e,i){return m.doWhilst(t,function(){return!e.apply(this,arguments)},i)},m.during=function(i,r,n){n=n||v;var o=_(function(t,e){t?n(t):(e.push(l),i.apply(this,e))}),l=function(t,e){t?n(t):e?r(o):n(null)};i(l)},m.doDuring=function(t,e,i){var r=0;m.during(function(t){r++<1?t(null,!0):e.apply(this,arguments)},t,i)},m.queue=function(i,t){return T(function(t,e){i(t[0],e)},t,1)},m.priorityQueue=function(t,e){function o(t,e){return t.priority-e.priority}function r(i,t,r,n){if(null!=n&&"function"!=typeof n)throw new Error("task callback must be a function");if(i.started=!0,y(t)||(t=[t]),0===t.length)return m.setImmediate(function(){i.drain()});b(t,function(t){var e={data:t,priority:r,callback:"function"==typeof n?n:v};i.tasks.splice(function(t,e,i){for(var r=-1,n=t.length-1;r<n;){var o=r+(n-r+1>>>1);0<=i(e,t[o])?r=o:n=o-1}return r}(i.tasks,e,o)+1,0,e),i.tasks.length===i.concurrency&&i.saturated(),m.setImmediate(i.process)})}var n=m.queue(t,e);return n.push=function(t,e,i){r(n,t,e,i)},delete n.unshift,n},m.cargo=function(t,e){return T(t,1,e)},m.log=k("log"),m.dir=k("dir"),m.memoize=function(i,r){var o={},l={},a=Object.prototype.hasOwnProperty;r=r||c;var t=_(function(t){var e=t.pop(),n=r.apply(null,t);a.call(o,n)?m.setImmediate(function(){e.apply(null,o[n])}):a.call(l,n)?l[n].push(e):(l[n]=[e],i.apply(null,t.concat([_(function(t){o[n]=t;var e=l[n];delete l[n];for(var i=0,r=e.length;i<r;i++)e[i].apply(null,t)})])))});return t.memo=o,t.unmemoized=i,t},m.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}},m.times=U(m.map),m.timesSeries=U(m.mapSeries),m.timesLimit=function(t,e,i,r){return m.mapLimit(o(t),e,i,r)},m.seq=function(){var e=arguments;return _(function(t){var r=this,i=t[t.length-1];"function"==typeof i?t.pop():i=v,m.reduce(e,t,function(t,e,i){e.apply(r,t.concat([_(function(t,e){i(t,e)})]))},function(t,e){i.apply(r,[t].concat(e))})})},m.compose=function(){return m.seq.apply(null,Array.prototype.reverse.call(arguments))},m.applyEach=L(m.eachOf),m.applyEachSeries=L(m.eachOfSeries),m.forever=function(t,e){var i=s(e||v),r=W(t);!function t(e){if(e)return i(e);r(t)}()},m.ensureAsync=W,m.constant=_(function(t){var e=[null].concat(t);return function(t){return t.apply(this,e)}}),m.wrapSync=m.asyncify=function(o){return _(function(t){var e,i,r,n=t.pop();try{e=o.apply(this,t)}catch(t){return n(t)}("function"==(r=typeof(i=e))||"object"==r&&i)&&"function"==typeof e.then?e.then(function(t){n(null,t)}).catch(function(t){n(t.message?t:new Error(t))}):n(null,e)})},"object"==typeof V&&V.exports?V.exports=m:r.async=m}()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("timers").setImmediate)},{_process:2,timers:3}],2:[function(t,e,i){var r,n,o=e.exports={};function l(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(e){if(r===setTimeout)return setTimeout(e,0);if((r===l||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:l}catch(t){r=l}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var u,s=[],p=!1,d=-1;function h(){p&&u&&(p=!1,u.length?s=u.concat(s):d=-1,s.length&&f())}function f(){if(!p){var t=c(h);p=!0;for(var e=s.length;e;){for(u=s,s=[];++d<e;)u&&u[d].run();d=-1,e=s.length}u=null,p=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];s.push(new g(t,e)),1!==s.length||p||c(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],3:[function(c,t,u){(function(t,e){var r=c("process/browser.js").nextTick,i=Function.prototype.apply,n=Array.prototype.slice,o={},l=0;function a(t,e){this._id=t,this._clearFn=e}u.setTimeout=function(){return new a(i.call(setTimeout,window,arguments),clearTimeout)},u.setInterval=function(){return new a(i.call(setInterval,window,arguments),clearInterval)},u.clearTimeout=u.clearInterval=function(t){t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},u.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},u.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},u._unrefActive=u.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},u.setImmediate="function"==typeof t?t:function(t){var e=l++,i=!(arguments.length<2)&&n.call(arguments,1);return o[e]=!0,r(function(){o[e]&&(i?t.apply(null,i):t.call(null),u.clearImmediate(e))}),e},u.clearImmediate="function"==typeof e?e:function(t){delete o[t]}}).call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":2,timers:3}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(t){t.translations("en",{FILE:"Upload pictures",WEB_LINK:"Use web link",CAMERA:"Take photo",IMAGE_GALLERY:"Use image library"}),t.translations("ru",{FILE:"Загрузить картинку",WEB_LINK:"Вставить веб ссылка",CAMERA:"Использовать камеру",IMAGE_GALLERY:"Открыть галерею изображений"})}var c=t("./AddImageOption");r.$inject=["pipTranslateProvider"];var n=(o.$inject=["$scope","$element","$mdMenu","$timeout","pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog"],o.prototype.openMenu=function(t){this.$scope.ngDisabled()||t()},o.prototype.toBoolean=function(t){return!!t&&("1"==(t=t.toString().toLowerCase())||"true"==t)},o.prototype.isMulti=function(){return void 0===this.$scope.multi||null===this.$scope.multi||(angular.isFunction(this.$scope.multi)?this.toBoolean(this.$scope.multi()):this.toBoolean(this.$scope.multi))},o.prototype.hideMenu=function(){this.$mdMenu.hide()},o.prototype.dataURItoBlob=function(t){var e;e=(0<=t.split(",")[0].indexOf("base64")?atob:unescape)(t.split(",")[1]);var i,r=t.split(",")[0].split(":")[1].split(";")[0],n=new Uint8Array(e.length);for(i=0;i<e.length;i++)n[i]=e.charCodeAt(i);return new Blob([n],{type:r})},o.prototype.addImages=function(t){var e=this;void 0!==t&&(angular.isArray(t)?t.forEach(function(t){e.$scope.onChange&&e.$scope.onChange(t)}):this.$scope.onChange&&this.$scope.onChange(t),void 0!==this.$scope.$images&&Array.isArray(this.$scope.$images)&&(Array.isArray(t)?t.forEach(function(t){e.$scope.$images.push(t)}):this.$scope.$images.push(t)))},o.prototype.onFileChange=function(t){var i=this;null!=t&&0!=t.length&&t.forEach(function(e){-1<e.type.indexOf("image")&&i.$timeout(function(){var t=new FileReader;t.readAsDataURL(e),t.onload=function(t){i.$timeout(function(){i.addImages({url:null,uriData:t.target.result,file:e,picture:null})})}})})},o.prototype.onWebLinkClick=function(){var i=this;this.pipPictureUrlDialog.show(function(t){var e=null;"data:image"==t.substring(0,10)&&((e=i.dataURItoBlob(t)).name=t.slice(t.lastIndexOf("/")+1,t.length).split("?")[0]),i.addImages({url:t,uriData:null,file:e,picture:null})})},o.prototype.onCameraClick=function(){var i=this;this.pipCameraDialog.show(function(t){var e=i.dataURItoBlob(t);e.name="camera",i.addImages({url:null,uriData:t,file:e,picture:null})})},o.prototype.onGalleryClick=function(){var i=this;this.pipGallerySearchDialog.show({multiple:this.isMulti()},function(t){if(i.isMulti()){var e=[];t.forEach(function(t){e.push({url:null,uriData:null,file:null,picture:t})}),i.addImages(e)}else i.addImages({url:null,uriData:null,file:null,picture:t[0]})})},o);function o(t,e,i,r,n,o,l){this.$scope=t,this.$element=e,this.$mdMenu=i,this.$timeout=r,this.pipCameraDialog=n,this.pipPictureUrlDialog=o,this.pipGallerySearchDialog=l;var a=new c.AddImageOption;this.option=_.assign(a,this.$scope.option)}angular.module("pipAddImage",["pipCameraDialog","pipPictureUrlDialog","pipGallerySearchDialog","angularFileUpload"]).config(r).directive("pipAddImage",function(){return{restrict:"AC",scope:{$images:"=pipImages",onChange:"&pipChanged",multi:"&pipMulti",option:"=pipOption",ngDisabled:"&"},transclude:!0,templateUrl:"add_image/AddImage.html",controller:n,controllerAs:"vm"}})},{"./AddImageOption":5}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){this.Upload=!0,this.WebLink=!0,this.Camera=!0,this.Galery=!0}i.AddImageOption=r},{}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.AddImageResult=r},{}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("../data/IAvatarDataService"),u=t("../avatar_edit/AvatarEdit"),n={bindings:{pipId:"<?",pipUrl:"<?",pipName:"<?",ngClass:"<?",pipRebindAvatar:"<?",pipRebind:"<?"},template:'<img/><div id="default-avatar">{{ $ctrl.initial }}</div>',controller:(o.$inject=["$log","$http","$rootScope","$element","pipAvatarData","pipPictureUtils","pipCodes","$timeout"],o.prototype.$postLink=function(){var e=this;this.imageElement=this.$element.children("img"),this.defaultAvatarElement=this.$element.find("#default-avatar"),this.imageElement.load(function(t){e.image=$(t.target),e.pipPictureUtils.setImageMarginCSS(e.$element,e.image)}).error(function(t){e.showAvatarByName()}),this.bindControl(),this.postLink=!0},o.prototype.$onChanges=function(t){var e=this;t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue),t.pipRebindAvatar&&t.pipRebindAvatar.currentValue!==t.pipRebindAvatar.previousValue&&(this.pipRebindAvatar=t.pipRebindAvatar.currentValue),t.ngClass&&t.ngClass.currentValue!==t.ngClass.previousValue&&(this.ngClass=t.ngClass.currentValue,setTimeout(function(){e.pipPictureUtils.setImageMarginCSS(e.$element,e.image)},50));var i=!1;this.pipRebind&&(t.pipId&&t.pipId.currentValue!==t.pipId.previousValue&&(this.pipId=t.pipId.currentValue,i=!0),t.pipUrl&&t.pipUrl.currentValue!==t.pipUrl.previousValue&&(this.pipUrl=t.pipUrl.currentValue,i=!0),t.pipName&&t.pipName.currentValue!==t.pipName.previousValue&&(this.pipName=t.pipName.currentValue,i=!0)),i&&this.postLink&&this.refreshAvatar()},o.prototype.showAvatarByName=function(){var e=this;this.$timeout(function(){var t=e.pipCodes.hash(e.pipId)%r.colors.length;e.defaultAvatarElement.removeAttr("class"),e.defaultAvatarElement.addClass(r.colorClasses[t]),e.imageElement.css("display","none"),e.defaultAvatarElement.css("display","inline-block")})},o.prototype.toBoolean=function(t){return!!t&&("1"==(t=t.toString().toLowerCase())||"true"==t)},o.prototype.refreshAvatar=function(){this.pipAvatarData.ShowOnlyNameIcon||(this.imageElement.attr("src",""),this.imageElement.css("display","inline-block"),this.defaultAvatarElement.css("display","none")),this.bindControl()},o.prototype.bindControl=function(){var t=this;if(this.pipRebindAvatar?this.cleanupAvatarUpdated=this.$rootScope.$on("pipPartyAvatarUpdated",function(){t.refreshAvatar()}):this.cleanupAvatarUpdated&&this.cleanupAvatarUpdated(),this.pipName?this.initial=this.pipName.charAt(0):this.initial=this.pipAvatarData.DefaultInitial,this.pipAvatarData.ShowOnlyNameIcon)this.showAvatarByName();else{var e=this.pipId?this.pipAvatarData.getAvatarUrl(this.pipId):this.pipUrl;this.imageElement.attr("src",e)}},o)};function o(t,e,i,r,n,o,l,a){var c=this;this.$log=t,this.$http=e,this.$rootScope=i,this.$element=r,this.pipAvatarData=n,this.pipPictureUtils=o,this.pipCodes=l,this.$timeout=a,this.postLink=!1,this.image=null,this.initial=this.pipAvatarData.DefaultInitial,r.addClass("pip-avatar flex-fixed"),this.$rootScope.$on(u.ReloadAvatar,function(t,e){c.pipId==e&&c.pipRebind&&c.refreshAvatar()})}angular.module("pipAvatar",["pipPictureUtils"]).component("pipAvatar",n)},{"../avatar_edit/AvatarEdit":8,"../data/IAvatarDataService":18}],8:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var d=t("../utilities/PicturePaste"),h=t("../add_image/AddImageOption");o.ReloadAvatar="pipReloadAvatar";var f=function(){this.disabled=!1,this.url="",this.progress=0,this.uploaded=!1,this.uploading=!1,this.upload=!1,this.loaded=!1,this.file=null,this.state=l.Original};o.AvatarEditControl=f;var l=function(){};l.Original="original",l.Changed="changed",l.Deleted="deleted",l.Error="error",o.AvatarStates=l;function i(t){t.translations("en",{PICTURE_EDIT_TEXT:"Click here to upload a picture",PICTURE_ERROR_LOAD:"Error image loading"}),t.translations("ru",{PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки",PICTURE_ERROR_LOAD:"Ошибка загрузки картинки"})}i.$inject=["pipTranslateProvider"];var r={bindings:{ngDisabled:"<?",pipCreated:"&?",pipChanged:"&?",pipReset:"<?",pipId:"<?",text:"<?pipDefaultText",icon:"<?pipDefaultIcon",pipRebind:"<?"},templateUrl:"picture_edit/PictureEdit.html",controller:(n.$inject=["$log","$scope","$http","$rootScope","$element","$timeout","pipAvatarData","pipCodes","pipPictureUtils","pipFileUpload","pipRest"],n.prototype.$postLink=function(){var e=this;this.controlElement=this.$element.children(".pip-picture-upload"),this.inputElement=this.controlElement.children("input[type=file]"),this.$element.children(".pip-picture-upload").focus(function(){e.pipPicturePaste.addPasteListener(function(t){e.readItemLocally(t.url,t.uriData,t.file,t.picture)})}),this.$element.children(".pip-picture-upload").blur(function(){e.pipPicturePaste.removePasteListener()}),this.pipCreated&&this.pipCreated({$event:{$control:this.control},$control:this.control}),this.control.reset()},n.prototype.$onChanges=function(t){t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue),t.pipReset&&t.pipReset.currentValue!==t.pipReset.previousValue&&(this.pipReset=t.pipReset.currentValue);var e=!1;this.pipRebind&&(t.pipId&&t.pipId.currentValue!==t.pipId.previousValue&&(this.pipId=t.pipId.currentValue,!1!==this.pipReset&&(e=!0)),t.ngDisabled&&t.ngDisabled.currentValue!==t.ngDisabled.previousValue&&(this.ngDisabled=t.ngDisabled.currentValue)),t.pipId&&t.pipId.currentValue&&this.control&&this.control.state!=l.Deleted&&this.control.state!=l.Changed&&(e=!0),e&&this.control.reset()},n.prototype.reset=function(t){if(this.control.progress=0,this.control.uploading=!1,this.control.uploaded=!1,this.control.file=null,this.control.state=l.Original,this.control.url="",this.control.uriData=null,t)this.onChange();else{var e=this.pipId?this.pipAvatarData.getAvatarUrl(this.pipId):"";if(!e)return;this.control.progress=0,this.control.url=e,this.control.uploaded=""!=this.control.url,this.onChange()}},n.prototype.saveAvatar=function(t,e,i){var r=this;if(t=t||this.pipId,null!==this.control.file){var n=new FormData;n.append("file",this.control.file),this.control.uploading=!0,this.$http.put(this.pipAvatarData.getAvatarUrl(t),n,{uploadEventHandlers:{progress:function(t){t.lengthComputable&&(r.control.progress=t.loaded/t.total*100)}},headers:{"Content-Type":void 0}}).success(function(t){r.control.progress=100,r.pipId=t.id,r.$rootScope.$broadcast(o.ReloadAvatar,r.pipId),r.control.reset(),e&&e(t)}).error(function(t){r.control.progress=0,r.control.uploading=!1,r.control.upload=!1,r.control.progress=0,r.control.state=l.Original,i?i(t):r.$log.error(t)})}},n.prototype.deletePicture=function(t,e){var i=this;this.pipAvatarData.deleteAvatar(this.pipId,function(){i.$rootScope.$broadcast(o.ReloadAvatar,i.pipId),i.control.reset(!0),t&&t()},function(t){i.control.uploading=!1,i.control.upload=!1,i.control.progress=0,i.control.state=l.Original,e?e(t):i.$log.error(t)})},n.prototype.save=function(t,e,i){this.control.state==l.Changed?this.saveAvatar(t,e,i):this.control.state==l.Deleted?this.deletePicture(e,i):e&&e()},n.prototype.empty=function(){return""==this.control.url&&!this.control.uploading},n.prototype.isUpdated=function(){return this.control.state!=l.Original},n.prototype.readItemLocally=function(t,e,i,r){r?this.control.url=this.pipAvatarData.getAvatarUrl(this.pipId):(this.control.file=i,this.control.url=i?e:t||""),this.control.state=l.Changed,this.onChange()},n.prototype.onDeleteClick=function(t){t&&t.stopPropagation(),this.controlElement.focus(),this.control.file=null,this.control.url="",this.control.state=l.Deleted,this.onChange()},n.prototype.onKeyDown=function(t){var e=this;13==t.keyCode||32==t.keyCode?setTimeout(function(){e.controlElement.trigger("click")},0):46==t.keyCode||8==t.keyCode?(this.control.file=null,this.control.url="",this.control.state=l.Deleted,this.onChange()):27==t.keyCode&&this.control.reset()},n.prototype.onImageError=function(e){var i=this;this.$scope.$apply(function(){i.control.url="";var t=$(e.target);i.control.state=l.Original,i.pipPictureUtils.setErrorImageCSS(t,{width:"auto",height:"100%"})})},n.prototype.onImageLoad=function(t){var e=$(t.target),i={clientWidth:80,clientHeight:80};this.pipPictureUtils.setImageMarginCSS(i,e),this.control.uploading=!1},n.prototype.onChange=function(){this.pipChanged&&this.pipChanged({$event:{$control:this.control},$control:this.control})},n)};function n(t,e,i,r,n,o,l,a,c,u,s){var p=this;this.$log=t,this.$scope=e,this.$http=i,this.$rootScope=r,this.$element=n,this.$timeout=o,this.pipAvatarData=l,this.pipCodes=a,this.pipPictureUtils=c,this.pipFileUpload=u,this.pipRest=s,this.pipPicturePaste=new d.PicturePaste(o),this.option=new h.AddImageOption,this.option.WebLink=!1,this.option.Galery=!1,this.text=this.text||"PICTURE_EDIT_TEXT",this.icon=this.icon||"picture-no-border",this.errorText="PICTURE_ERROR_LOAD",this.control=new f,this.multiUpload=!1,this.control.reset=function(t){p.reset(t)},this.control.save=function(t,e,i){p.save(t,e,i)},n.addClass("pip-picture-edit")}angular.module("pipAvatarEdit",["ui.event","pipPictureUtils","pipPictures.Templates","pipFiles"]).config(i).component("pipAvatarEdit",r)},{"../add_image/AddImageOption":5,"../utilities/PicturePaste":43}],9:[function(t,e,i){function r(t){t.translations("en",{TAKE_PICTURE:"Take a picture",WEB_CAM_ERROR:"Webcam is missing or was not found"}),t.translations("ru",{TAKE_PICTURE:"Сделать фото",WEB_CAM_ERROR:"Web-камера отсутствует или не найдена"})}r.$inject=["pipTranslateProvider"];var n=(o.$inject=["$mdDialog","$rootScope","$timeout","$mdMenu","pipSystemInfo"],o.prototype.onInit=function(){var e=this;"android"!==this.browser?(Webcam.init(),setTimeout(function(){Webcam.attach(".camera-stream")},0),Webcam.on("error",function(t){e.webCamError=!0,console.error(t)}),Webcam.set({width:400,height:300,dest_width:400,dest_height:300,crop_width:400,crop_height:300,image_format:"jpeg",jpeg_quality:90}),Webcam.setSWFLocation("webcam.swf")):document.addEventListener("deviceready",this.onDeviceReady,!1)},o.prototype.onDeviceReady=function(){var e=this;navigator.camera.getPicture(function(t){e.onSuccess(t)},function(t){e.onFail(t)},{sourceType:Camera.PictureSourceType.CAMERA,correctOrientation:!0,quality:75,targetWidth:200,destinationType:Camera.DestinationType.DATA_URL})},o.prototype.onSuccess=function(t){var e="data:image/jpeg;base64,"+t;this.$mdDialog.hide(e)},o.prototype.onFail=function(t){alert("Failed because: "+t),this.$mdDialog.hide()},o.prototype.onTakePictureClick=function(){var e=this;Webcam&&(this.freeze?Webcam.snap(function(t){e.freeze=!1,e.$mdDialog.hide(t)}):(this.freeze=!0,Webcam.freeze()))},o.prototype.onResetPicture=function(){this.freeze=!1,Webcam.unfreeze()},o.prototype.onCancelClick=function(){this.$mdDialog.cancel()},o);function o(t,e,i,r,n){this.$mdDialog=t,this.$rootScope=e,this.$timeout=i,this.$mdMenu=r,this.pipSystemInfo=n,this.theme=this.$rootScope[pip.themes.ThemeRootVar],this.browser=this.pipSystemInfo.os,this.freeze=!1,this.onInit()}angular.module("pipCameraDialog").config(r).controller("pipCameraDialogController",n)},{}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=(n.$inject=["$mdDialog"],n.prototype.show=function(e,t){this._mdDialog.show({templateUrl:"camera_dialog/CameraDialog.html",clickOutsideToClose:!0,controller:"pipCameraDialogController",controllerAs:"$ctrl"}).then(function(t){Webcam.reset(),e&&e(t)},function(){Webcam.reset()})},n);function n(t){this._mdDialog=t}angular.module("pipCameraDialog").service("pipCameraDialog",r)},{}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipCameraDialog",["ngMaterial","pipServices","pipPictures.Templates"]),t("./ICameraDialogService"),t("./CameraDialogService"),t("./CameraDialogController")},{"./CameraDialogController":9,"./CameraDialogService":10,"./ICameraDialogService":11}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r={bindings:{pipPictureIds:"<?",pipSrcs:"<?",pipPictures:"<?",uniqueCode:"<?pipUniqueCode",multiple:"<?pipMultiple",allowOpen:"<?pipOpen",pipRebind:"<?"},controller:(n.$inject=["$log","$scope","$rootScope","$element","pipPictureData","pipPictureUtils","pipCodes"],n.prototype.$postLink=function(){var i=this;this.$scope.getElementDimensions=function(){return{h:i.$element.height(),w:i.$element.width()}},this.$scope.$watch(this.$scope.getElementDimensions,function(t,e){t&&e&&e.h==t.h&&e.w==t.w||i.debounceCalculateResize()},!0),this.generateContent()},n.prototype.$onChanges=function(t){t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue),t.allowOpen&&t.allowOpen.currentValue!==t.allowOpen.previousValue&&(this.allowOpen=t.allowOpen.currentValue);var e=!1;this.pipRebind&&(t.pipSrcs&&!_.isEqual(t.pipSrcs.currentValue,t.pipSrcs.previousValue)&&(this.pipSrcs=t.pipSrcs.currentValue,e=!0),t.pipPictureIds&&!_.isEqual(t.pipPictureIds.currentValue,t.pipPictureIds.previousValue)&&(this.pipPictureIds=t.pipPictureIds.currentValue,e=!0),t.pipPictures&&!_.isEqual(t.pipPictures.currentValue,t.pipPictures.previousValue)&&(this.pipPictures=t.pipPictures.currentValue,e=!0)),e&&this.generateContent()},n.prototype.calculateResize=function(){for(var t=this.$element.find("img"),e=0;e<t.length;e++){var i=angular.element(t[e].parentElement),r=angular.element(t[e]);"none"!=r.css("display")&&this.pipPictureUtils.setImageMarginCSS(i,r)}for(var n=this.$element.find("md-icon");e<n.length;e++){i=angular.element(n[e].parentElement);var o=angular.element(n[e]);"none"!=i.css("display")&&this.pipPictureUtils.setIconMarginCSS(i[0],o)}},n.prototype.onImageError=function(t){var e=$(t.target),i=e.parent(),r=i.children("div"),n=e.parent().find("md-icon");r.css("display","block"),e.css("display","none"),this.pipPictureUtils.setIconMarginCSS(i[0],n),n.empty().append(this.svgData)},n.prototype.onImageLoad=function(t){var e=$(t.target),i=e.parent(),r=i.children("div");this.pipPictureUtils.setImageMarginCSS(i,e),r.css("display","none")},n.prototype.getScheme=function(t){var e=this.collageSchemes[t-1];if(1==e.length)return e[0];var i=this.uniqueCode?this.uniqueCode:"";return e[this.pipCodes.hash(i)%e.length]},n.prototype.getImageUrls=function(){if(this.pipSrcs)return _.clone(this.pipSrcs);var t,e=[];if(this.pipPictureIds)for(t=0;t<this.pipPictureIds.length;t++)e.push(this.pipPictureData.getPictureUrl(this.pipPictureIds[t]));else if(this.pipPictures)for(t=0;t<this.pipPictures.length;t++){var i=this.pipPictures[t].uri?this.pipPictures[t].uri:this.pipPictureData.getPictureUrl(this.pipPictures[t].id);e.push(i)}return e},n.prototype.generatePicture=function(t,e){var i=t[0],r="",n="";return t.splice(0,1),r+=e.fullWidth?" pip-full-width":"",r+=e.fullHeight?" pip-full-height":"",r+=" flex-"+e.flex,n+=e.leftPadding?" pip-left":"",n+=e.rightPadding?" pip-right":"",n+=e.topPadding?" pip-top":"",n+=e.bottomPadding?" pip-bottom":"",this.allowOpen?'<a class="pip-picture-container'+r+'" flex="'+e.flex+'" href="'+i+'"  target="_blank"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon class="collage-error-icon" md-svg-icon="icons:picture-no-border"></md-icon></div></div></a>':'<div class="pip-picture-container'+r+'" flex="'+e.flex+'"><div class="pip-picture'+n+'"><img src="'+i+'"/><div><md-icon class="collage-error-icon" md-svg-icon="icons:picture-no-border"></md-icon></div></div></div>'},n.prototype.generatePictureGroup=function(t,e){var i,r,n="";for(n+=e.fullWidth?" pip-full-width":"",n+=e.fullHeight?" pip-full-height":"",n+=" flex-"+e.flex,i='<div class="pip-picture-group layout'+(n+=" layout-"+e.layout)+'" flex="'+e.flex+'" layout="'+e.layout+'">',r=0;r<e.children.length;r++)i+=this.generate(t,e.children[r]);return i+="</div>"},n.prototype.generate=function(t,e){return e.group?this.generatePictureGroup(t,e):this.generatePicture(t,e)},n.prototype.generateContent=function(){var e=this;this.$element.find("img").unbind("error").unbind("load"),this.$element.empty();var t,i,r=this.getImageUrls();if(0!=r.length){if(8<r.length&&(this.multiple||(r.length=8)),r.length<=8)t=this.getScheme(r.length),i='<div class="pip-collage-section">'+this.generate(r,t)+"</div>",i+='<div class="clearfix"></div>',this.$element.html(i);else{for(i="";0<r.length;){var n=r.splice(0,8);t=this.getScheme(n.length),i+='<div class="pip-collage-section">'+this.generate(n,t)+"</div>"}i+='<div class="clearfix"></div>',this.$element.html(i)}this.$element.find("img").bind("error",function(t){e.onImageError(t)}).bind("load",function(t){e.onImageLoad(t)}),this.$element.show()}else this.$element.hide()},n)};function n(t,e,i,r,n,o,l){var a=this;this.$log=t,this.$scope=e,this.$rootScope=i,this.$element=r,this.pipPictureData=n,this.pipPictureUtils=o,this.pipCodes=l,r.addClass("pip-collage"),this.collageSchemes=o.getCollageSchemes(),this.resized=0,this.svgData='<?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1"xmlns="http://www.w3.org/2000/svg"xmlns:xlink="http://www.w3.org/1999/xlink"x="0px" y="0px"viewBox="0 0 510 510"style="enable-background:new 0 0 515 515;"xml:space="preserve"><defs><style type="text/css"><![CDATA[#symbol-picture-no-border {        transform-origin: 50% 50%;        transform: scale(0.6, -0.6);    }        ]]></style>        </defs><rect x="0" width="515" height="515"/><path id="symbol-picture-no-border" d="M120 325l136-102 69 33 136-82 0-54-410 0 0 136z m341 15c0-28-23-51-51-51-29 0-52 23-52 51 0 29 23 52 52 52 28 0 51-23 51-52z" /></svg>',this.debounceCalculateResize=_.debounce(function(){a.calculateResize()},50)}angular.module("pipCollage",[]).component("pipCollage",r)},{}],14:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(t,e,i){this.id=t,this.uri=e,this.name=i}i.Attachment=r},{}],15:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("./IAvatarDataService"),n=(o.$inject=["_config","pipRest"],Object.defineProperty(o.prototype,"AvatarRoute",{get:function(){return this._config.AvatarRoute},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"ShowOnlyNameIcon",{get:function(){return this._config.ShowOnlyNameIcon},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"DefaultInitial",{get:function(){return this._config.DefaultInitial},enumerable:!0,configurable:!0}),o.prototype.getAvatarUrl=function(t){return this.pipRest.serverUrl+this._config.AvatarRoute+"/"+t},o.prototype.postAvatarUrl=function(){return this.pipRest.serverUrl+this._config.AvatarRoute},o.prototype.deleteAvatar=function(t,e,i){var r={};r[this._config.AvatarFieldId]=t,this.pipRest.getResource(this._config.AvatarResource).remove(r,null,e,i)},o.prototype.createAvatar=function(t,e,i,r){},o);function o(t,e){this._config=t,this.pipRest=e}var l=(a.$inject=["pipRestProvider"],Object.defineProperty(a.prototype,"AvatarRoute",{get:function(){return this._config.AvatarRoute},set:function(t){this._config.AvatarRoute=t,this.pipRestProvider.registerOperation("avatars",this._config.AvatarRoute+"/:avatar_id")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AvatarResource",{get:function(){return this._config.AvatarResource},set:function(t){this._config.AvatarResource=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"AvatarFieldId",{get:function(){return this._config.AvatarFieldId},set:function(t){this._config.AvatarFieldId=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShowOnlyNameIcon",{get:function(){return this._config.ShowOnlyNameIcon},set:function(t){this._config.ShowOnlyNameIcon=t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"DefaultInitial",{get:function(){return this._config.DefaultInitial},set:function(t){this._config.DefaultInitial=t},enumerable:!0,configurable:!0}),a.prototype.$get=["pipRest",function(t){return null==this._service&&(this._service=new n(this._config,t)),this._service}],a);function a(t){this.pipRestProvider=t,this._config=new r.AvatarConfig,this._config.AvatarRoute="/api/1.0/avatars",this._config.AvatarResource="avatars",this._config.AvatarFieldId="avatar_id",this._config.ShowOnlyNameIcon=!1,this._config.DefaultInitial="&"}angular.module("pipAvatarData",["pipRest"]).provider("pipAvatarData",l)},{"./IAvatarDataService":18}],16:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(t,e,i,r,n,o,l,a){this.id=t,this.group=e,this.name=i,this.size=r,this.content_type=n,this.create_time=o,this.expire_time=l,this.completed=a}i.BlobInfo=r},{}],17:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.total=e,this.data=t}i.DataPage=r},{}],18:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.AvatarConfig=r,i.colorClasses=["pip-avatar-color-0","pip-avatar-color-1","pip-avatar-color-2","pip-avatar-color-3","pip-avatar-color-4","pip-avatar-color-5","pip-avatar-color-6","pip-avatar-color-7","pip-avatar-color-8","pip-avatar-color-9","pip-avatar-color-10","pip-avatar-color-11","pip-avatar-color-12","pip-avatar-color-13","pip-avatar-color-14","pip-avatar-color-15"],i.colors=["rgba(239,83,80,1)","rgba(236,64,122,1)","rgba(171,71,188,1)","rgba(126,87,194,1)","rgba(92,107,192,1)","rgba(3,169,244,1)","rgba(0,188,212,1)","rgba(0,150,136,1)","rgba(76,175,80,1)","rgba(139,195,74,1)","rgba(205,220,57,1)","rgba(255,193,7,1)","rgba(255,152,0,1)","rgba(255,87,34,1)","rgba(121,85,72,1)","rgba(96,125,139,1)"]},{}],19:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],20:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.PictureConfig=r},{}],21:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.Image=r},{}],22:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(t,e,i,r){this.id=t,this.title=e,this.pics=[],this.create_time=r}i.ImageSet=r},{}],23:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=(n.$inject=["pipRest","pipFormat"],n.prototype.readImageSets=function(t,e,i){return t=t||{},this.pipRest.getResource(this.RESOURCE).page(t,e,i)},n.prototype.readImageSet=function(t,e,i){return this.pipRest.getResource(this.RESOURCE).get({imagesets_id:t},e,i)},n.prototype.updateImageSet=function(t,e,i,r){this.pipRest.getResource(this.RESOURCE).update({imagesets_id:t},e,i,r)},n.prototype.createImageSet=function(t,e,i){this.pipRest.getResource(this.RESOURCE).save(null,t,e,i)},n.prototype.deleteImageSet=function(t,e,i){this.pipRest.getResource(this.RESOURCE).remove({imagesets_id:t},null,e,i)},n);function n(t,e){this.pipRest=t,this.pipFormat=e,this.RESOURCE="imagesets"}angular.module("pipImageSetData",["pipRest"]).service("pipImageSetData",r)},{}],24:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=t("./IPictureDataService"),n=(o.$inject=["_config","pipFormat","pipRest"],Object.defineProperty(o.prototype,"PictureRoute",{get:function(){return this._config.PictureRoute},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"ShowErrorIcon",{get:function(){return this._config.ShowErrorIcon},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"DefaultErrorIcon",{get:function(){return this._config.DefaultErrorIcon},enumerable:!0,configurable:!0}),o.prototype.getPictureUrl=function(t){return this.pipRest.serverUrl+this._config.PictureRoute+"/"+t},o.prototype.postPictureUrl=function(){return this.pipRest.serverUrl+this._config.PictureRoute},o.prototype.readPictures=function(t,e,i){return(t=t||{}).filter&&(t.filer=this.pipFormat.filterToString(t.filer)),this.pipRest.getResource(this.RESOURCE).page(t,e,i)},o.prototype.readPictureInfo=function(t,e,i){return(t=t||{}).filter&&(t.filer=this.pipFormat.filterToString(t.filer)),this.pipRest.getResource(this.RESOURCE_INFO).get(t,e,i)},o.prototype.readPicture=function(t,e,i){return this.pipRest.getResource(this.RESOURCE).get({picture_id:t},e,i)},o.prototype.deletePicture=function(t,e,i){this.pipRest.getResource(this.RESOURCE).remove({picture_id:t},null,e,i)},o);function o(t,e,i){this._config=t,this.pipFormat=e,this.pipRest=i,this.RESOURCE="picture",this.RESOURCE_INFO="pictureInfo"}var l=(a.$inject=["pipRestProvider"],Object.defineProperty(a.prototype,"PictureRoute",{get:function(){return this._config.PictureRoute},set:function(t){this._config.PictureRoute=t,this.pipRestProvider.registerOperation("pictures",this._config.PictureRoute+"/:picture_id")},enumerable:!0,configurable:!0}),a.prototype.getPictureUrl=function(t){return this.pipRestProvider.serverUrl+this._config.PictureRoute+"/"+t},Object.defineProperty(a.prototype,"DefaultErrorIcon",{get:function(){return this._config.DefaultErrorIcon},set:function(t){this._config.DefaultErrorIcon=t,this.pipRestProvider.registerOperation("pictures",this._config.PictureRoute+"/:picture_id")},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ShowErrorIcon",{get:function(){return this._config.ShowErrorIcon},set:function(t){this._config.ShowErrorIcon=t},enumerable:!0,configurable:!0}),a.prototype.$get=["pipRest","pipFormat",function(t,e){return null==this._service&&(this._service=new n(this._config,e,t)),this._service}],a);function a(t){this.pipRestProvider=t,this._config=new r.PictureConfig,this._config.PictureRoute="/api/1.0/blobs",this._config.ShowErrorIcon=!0,this._config.DefaultErrorIcon="picture-no-border"}angular.module("pipPictureData",["pipRest"]).provider("pipPictureData",l)},{"./IPictureDataService":20}],25:[function(t,e,i){"use strict";function r(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}Object.defineProperty(i,"__esModule",{value:!0}),t("./Attachment"),t("./BlobInfo"),t("./DataPage"),t("./ImageSet"),t("./Image"),t("./AvatarDataService"),t("./IAvatarDataService"),t("./ImageSetDataService"),t("./IImageSetDataService"),t("./PictureDataService"),t("./IPictureDataService"),angular.module("pipPictures.Data",["pipAvatarData","pipPictureData","pipImageSetData"]),r(t("./Attachment")),r(t("./BlobInfo")),r(t("./DataPage")),r(t("./ImageSet")),r(t("./Image")),r(t("./IAvatarDataService")),r(t("./IPictureDataService"))},{"./Attachment":14,"./AvatarDataService":15,"./BlobInfo":16,"./DataPage":17,"./IAvatarDataService":18,"./IImageSetDataService":19,"./IPictureDataService":20,"./Image":21,"./ImageSet":22,"./ImageSetDataService":23,"./PictureDataService":24}],26:[function(t,e,i){"use strict";var r,n=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},function(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(i,"__esModule",{value:!0});function o(t){t.translations("en",{IMAGE_GALLERY:"Add from image gallery",SEARCH_PICTURES:"Search for pictures...",IMAGE_START_SEARCH:"Images will appear here once you start searching"}),t.translations("ru",{IMAGE_GALLERY:"Добавить из галереи изображений",SEARCH_PICTURES:"Поиск изображений...",IMAGE_START_SEARCH:"Картинки появятся после начала поиска"})}var l=t("./IGallerySearchDialogService");o.$inject=["pipTranslateProvider"];var d,a=(d=l.GallerySearchDialogParams,n(c,d),c.$inject=["$log","$mdDialog","$rootScope","$timeout","$mdMenu","multiple","$http","pipRest","pipTransaction","pipImageSetData","pipPictureData"],c.prototype.onSearchClick=function(){var i=this;if(!this.transaction.busy()&&""!=this.search&&this.search!=this.prevSearch){this.prevSearch=this.search,this.imagesSearchResult=[];var e=this.transaction.begin("ENTERING");e&&this.pipImageSetData.readImageSets({Search:this.search},function(t){i.transaction.aborted(e)||(_.each(t.data,function(t){_.each(t.pics,function(t){var e={checked:!1,url:t.uri?t.uri:i.pipPictureData.getPictureUrl(t.id),item:t,thumbnail:t.uri?t.uri:i.pipPictureData.getPictureUrl(t.id)};i.imagesSearchResult.push(e)})}),i.transaction.end())},function(t){i.transaction.end(t),i.$log.error(t)})}},c.prototype.onStopSearchClick=function(){this.transaction.abort(),this.prevSearch=""},c.prototype.onKeyPress=function(t){13===t.keyCode&&this.onSearchClick()},c.prototype.onImageClick=function(t){this.transaction.busy()||(t.checked=!t.checked,this.multiple?t.checked?this.images.push(t):_.remove(this.images,{url:t.url}):t.checked?0<this.images.length?(this.images[0].checked=!1,this.images[0]=t):this.images.push(t):this.images=[])},c.prototype.onAddClick=function(){if(!this.transaction.busy()){var e=[];this.images.forEach(function(t){t.checked&&e.push(t.item)}),this.$mdDialog.hide(e)}},c.prototype.onCancelClick=function(){this.$mdDialog.cancel()},c.prototype.addButtonDisabled=function(){return 0==this.images.length||this.transaction.busy()},c.prototype.focusSearchText=function(){setTimeout(function(){var t=$(".pip-gallery-search-dialog .search-images");0<t.length&&t.focus()},0)},c);function c(t,e,i,r,n,o,l,a,c,u,s){var p=d.call(this)||this;return p.$log=t,p.$mdDialog=e,p.$rootScope=i,p.$timeout=r,p.$mdMenu=n,p.multiple=o,p.$http=l,p.pipRest=a,p.pipTransaction=c,p.pipImageSetData=u,p.pipPictureData=s,p.prevSearch="",p.images=[],p.theme=p.$rootScope[pip.themes.ThemeRootVar],p.search="",p.imagesSearchResult=[],p.transaction=p.pipTransaction.create("search"),p.focusSearchText(),p}angular.module("pipGallerySearchDialog").config(o).controller("pipGallerySearchController",a)},{"./IGallerySearchDialogService":28}],27:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=(n.$inject=["$mdDialog"],n.prototype.show=function(t,e,i){this._mdDialog.show({templateUrl:"gallery_search_dialog/GallerySearchDialog.html",clickOutsideToClose:!0,controller:"pipGallerySearchController",controllerAs:"$ctrl",locals:t}).then(function(t){e&&e(t)})},n);function n(t){this._mdDialog=t}angular.module("pipGallerySearchDialog").service("pipGallerySearchDialog",r)},{}],28:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.GallerySearchDialogParams=r},{}],29:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipGallerySearchDialog",["ngMaterial","pipPictures.Templates","pipCommonRest"]),t("./IGallerySearchDialogService"),t("./GallerySearchDialogService"),t("./GallerySearchDialogController"),function(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}(t("./IGallerySearchDialogService"))},{"./GallerySearchDialogController":26,"./GallerySearchDialogService":27,"./IGallerySearchDialogService":28}],30:[function(t,e,i){"use strict";function r(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}Object.defineProperty(i,"__esModule",{value:!0}),t("./data"),t("./rest"),t("./camera_dialog"),t("./add_image/AddImage"),t("./add_image/AddImageOption"),t("./add_image/AddImageResult"),t("./avatar/Avatar"),t("./avatar_edit/AvatarEdit"),t("./collage/Collage"),t("./gallery_search_dialog"),t("./picture/Picture"),t("./picture_edit/PictureEdit"),t("./picture_list_edit/PictureListEdit"),t("./picture_url_dialog"),t("./utilities"),angular.module("pipPictures",["pipControls","pipPictures.Data","pipPictures.Rest","pipCameraDialog","pipGallerySearchDialog","pipPictureUrlDialog","pipAddImage","pipAvatar","pipPictureUtils","pipPicturePaste","pipAvatarEdit","pipPicture","pipPictureEdit","pipCollage","pipPictureListEdit"]),r(t("./data")),r(t("./avatar_edit/AvatarEdit")),r(t("./add_image/AddImageOption")),r(t("./add_image/AddImageResult")),r(t("./gallery_search_dialog")),r(t("./picture_edit/PictureEdit")),r(t("./picture_list_edit/PictureListEdit")),r(t("./utilities"))},{"./add_image/AddImage":4,"./add_image/AddImageOption":5,"./add_image/AddImageResult":6,"./avatar/Avatar":7,"./avatar_edit/AvatarEdit":8,"./camera_dialog":12,"./collage/Collage":13,"./data":25,"./gallery_search_dialog":29,"./picture/Picture":31,"./picture_edit/PictureEdit":32,"./picture_list_edit/PictureListEdit":33,"./picture_url_dialog":37,"./rest":41,"./utilities":45}],31:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r={bindings:{src:"<?pipSrc",pictureId:"<?pipPictureId",pipPicture:"<?",defaultIcon:"<?pipDefaultIcon",pipRebind:"<?"},template:'<img ui-event="{ error: \'$ctrl.onImageError($event)\', load: \'$ctrl.onImageLoad($event)\' }"/><div class="pip-picture-error"><md-icon md-svg-icon="icons:{{$ctrl.defaultIcon}}"></md-icon><div class="pip-default-text"><span>{{ $ctrl.errorText | translate }}</span></div></div>',controller:(n.$inject=["$scope","$rootScope","$element","pipPictureUtils","pipPictureData"],n.prototype.$postLink=function(){this.imageElement=this.$element.children("img"),this.defaultBlock=this.$element.children("div"),this.defaultIcon=this.defaultIcon?this.defaultIcon:this.pipPictureData.DefaultErrorIcon,this.postLink=!0,this.bindControl()},n.prototype.$onChanges=function(t){t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue);var e=!1;this.pipRebind&&(t.src&&t.src.currentValue!==t.src.previousValue&&(this.src=t.src.currentValue,e=!0),t.pictureId&&t.pictureId.currentValue!==t.pictureId.previousValue&&(this.pictureId=t.pictureId.currentValue,e=!0),t.pipPicture&&!_.isEqual(t.pipPicture.currentValue,t.pipPicture.previousValue)&&(this.pipPicture=t.pipPicture.currentValue,e=!0),t.defaultIcon&&t.defaultIcon.currentValue!==t.defaultIcon.previousValue&&(this.defaultIcon=t.defaultIcon.currentValue,this.defaultIcon=this.defaultIcon?this.defaultIcon:this.pipPictureData.DefaultErrorIcon)),e&&this.postLink&&this.bindControl()},n.prototype.onImageError=function(t){var e=this;this.pipPictureData.ShowErrorIcon?this.$scope.$apply(function(){e.imageElement.css("display","none"),e.defaultBlock.css("display","block")}):this.$scope.$apply(function(){e.defaultBlock.css("display","none")})},n.prototype.onImageLoad=function(t){var e=$(t.target);this.pipPictureUtils.setImageMarginCSS(this.$element,e),this.$element.children("div").css("display","none")},n.prototype.bindControl=function(){var t;this.pictureId?(t=this.pipPictureData.getPictureUrl(this.pictureId),this.imageElement.attr("src",t)):this.src?this.imageElement.attr("src",this.src):this.pipPicture&&(t=this.pipPicture.uri?this.pipPicture.uri:this.pipPictureData.getPictureUrl(this.pipPicture.id),this.imageElement.attr("src",t))},n)};function n(t,e,i,r,n){this.$scope=t,this.$rootScope=e,this.$element=i,this.pipPictureUtils=r,this.pipPictureData=n,this.postLink=!1,this.errorText="PICTURE_ERROR_LOAD",this.$element.addClass("pip-picture")}angular.module("pipPicture",[]).component("pipPicture",r)},{}],32:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=t("../utilities/PicturePaste"),s=function(){this.disabled=!1,this.url="",this.progress=0,this.uploaded=!1,this.uploading=!1,this.upload=!1,this.loaded=!1,this.file=null,this.state=p.Original};i.PictureEditControl=s;var p=function(){};p.Original="original",p.Copied="copied",p.Changed="changed",p.Deleted="deleted",p.Error="error",i.PictureStates=p;function r(t){t.translations("en",{ERROR_WRONG_IMAGE_FILE:"Incorrect image file. Please, choose another one",PICTURE_EDIT_TEXT:"Click here to upload a picture",PICTURE_ERROR_LOAD:"Error image loading"}),t.translations("ru",{ERROR_WRONG_IMAGE_FILE:"Неправильный файл с изображением. Выберете другой файл",PICTURE_EDIT_TEXT:"Нажмите сюда для загрузки картинки",PICTURE_ERROR_LOAD:"Ошибка загрузки картинки"})}r.$inject=["pipTranslateProvider"];var n={bindings:{ngDisabled:"<?",pipCreated:"&?",pipChanged:"&?",pipPictureId:"=?",pipPicture:"=?",pipAddedPicture:"&?",text:"<?pipDefaultText",icon:"<?pipDefaultIcon",pipRebind:"<?"},templateUrl:"picture_edit/PictureEdit.html",controller:(o.$inject=["$log","$scope","$rootScope","$element","pipPictureData","pipPictureUtils","$timeout","pipFileUpload"],o.prototype.$postLink=function(){this.controlElement=this.$element.children(".pip-picture-upload"),this.inputElement=this.controlElement.children("input[type=file]"),this.control.reset(),this.pipCreated&&this.pipCreated({$event:{sender:this.control},$control:this.control})},o.prototype.abort=function(){this.control.uploading&&(this.control.uploaded=!1,this.control.uploading=!1,this.control.progress=0,this.control.upload=null)},o.prototype.$onChanges=function(t){t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue);var e=!1;t.ngDisabled&&t.ngDisabled.currentValue!==t.ngDisabled.previousValue&&(this.ngDisabled=t.ngDisabled.currentValue,this.control.disabled=this.ngDisabled,this.inputElement&&this.inputElement.attr("disabled",this.control.disabled)),this.pipRebind&&t.pipPictureId&&t.pipPictureId.currentValue!==this.pipPictureId&&(this.pipPictureId=t.pipPictureId.currentValue,e=!0),this.pipRebind&&t.pipPicture&&!_.isEqual(t.pipPicture.currentValue,this.pipPicture)&&(this.pipPicture=t.pipPicture.currentValue,e=!0),e&&this.control.reset()},o.prototype.resetImage=function(t){this.control.progress=0,this.control.uploading=!1,this.control.uploaded=!1,this.control.file=null,this.control.state=this.pictureStartState,this.control.url="",this.control.uri=null,this.control.name=null,this.control.uriData=null,this.control.id=null;var e="";if(t)this.onChange();else{if(this.pipPictureId?e=this.pipPictureData.getPictureUrl(this.pipPictureId):this.pipPicture&&(e=this.pipPicture.uri?this.pipPicture.uri:this.pipPicture.id?this.pipPictureData.getPictureUrl(this.pipPicture.id):null,this.control.uri=this.pipPicture.uri,this.control.name=this.pipPicture.name,this.control.id=this.pipPicture.id),!e)return;this.control.url=e,this.control.uploaded=!0,this.onChange()}},o.prototype.onFocus=function(){var e=this;this.pipPicturePaste.addPasteListener(function(t){e.readItemLocally(t.url,t.uriData,t.file,t.picture)})},o.prototype.onBlur=function(){this.pipPicturePaste.removePasteListener()},o.prototype.savePicture=function(i,r){var n=this;this.control.id?(this.control.uploading=!1,this.pipPicture={id:this.control.id,uri:this.control.uri,name:this.control.name},this.pictureStartState=p.Original,this.control.reset(),i&&i(this.pipPicture)):null!==this.control.file?(this.control.uploading=!0,this.pipFileUpload.upload(this.control.file,this.pipPictureData.postPictureUrl(),function(t,e){e?(n.control.uploading=!1,n.control.upload=!1,n.control.progress=0,n.pictureStartState=p.Error,r?r(e):n.$log.error(e)):(n.pipPictureId=t.id,n.pipPicture={id:t.id,uri:null,name:t.name},n.pictureStartState=p.Original,n.control.reset(),i&&i(n.pipPicture))},function(t,e){n.control.progress=e})):this.control.uri&&this.pipPicture&&(this.control.uploading=!1,this.control.uri&&(this.pipPicture={id:this.control.id,uri:this.control.uri,name:this.control.name},this.pictureStartState=p.Original,this.control.reset(),i&&i(this.pipPicture)))},o.prototype.deletePicture=function(t,e){var i=this;this.pipPictureId?this.pipPictureData.deletePicture(this.pipPictureId,function(){i.pipPictureId=null,i.control.reset(!0),t&&t()},function(t){i.control.uploading=!1,i.control.upload=!1,i.control.progress=0,i.control.state=p.Error,e?e(t):i.$log.error(t)}):(this.control.uploading=!1,this.pipPicture={id:null,uri:null,name:null},this.control.reset(!0),t&&t(this.pipPicture))},o.prototype.saveImage=function(t,e){this.control.state==p.Changed?this.savePicture(t,e):this.control.state==p.Deleted?this.deletePicture(t,e):this.control.state==p.Copied?(this.pipPicture={id:this.control.id,name:this.control.name,uri:this.control.uri},this.pictureStartState=p.Original,this.control.reset(),t(this.pipPicture)):t&&(this.pipPicture?t(this.pipPicture):t(this.pipPictureId))},o.prototype.empty=function(){return""==this.control.url&&!this.control.uploading},o.prototype.isUpdated=function(){return this.control.state!=p.Original},o.prototype.readItemLocally=function(t,e,i,r){r?(this.control.file=null,this.control.name=r.name,this.control.uri=r.uri,this.control.id=r.id,this.control.uriData=null,this.control.url=r.uri?r.uri:r.id?this.pipPictureData.getPictureUrl(r.id):"",this.control.state,p.Copied):(this.control.file=i,this.control.name=i?i.name:t?t.split("/").pop():null,this.control.url=!i&&t?t:e||"",this.control.uri=!i&&t?t:null,this.control.uriData=e,this.control.id=null,this.control.state=p.Changed),this.onChange()},o.prototype.onDeleteClick=function(t){t.stopPropagation(),this.controlElement.focus(),this.control.file=null,this.control.url="",this.control.uri=null,this.control.uriData=null,this.control.name=null,this.control.id=null,this.control.state!=p.Copied&&(this.control.state=p.Deleted),this.onChange()},o.prototype.onKeyDown=function(t){var e=this;13==t.keyCode||32==t.keyCode?setTimeout(function(){e.controlElement.trigger("click")},0):46==t.keyCode||8==t.keyCode?(this.control.file=null,this.control.url="",this.control.state=p.Deleted,this.onChange()):27==t.keyCode&&this.control.reset()},o.prototype.onImageError=function(e){var i=this;this.$scope.$apply(function(){i.control.url="";var t=$(e.target);i.control.state=p.Error,i.pipPictureUtils.setErrorImageCSS(t,{width:"auto",height:"100%"})})},o.prototype.onImageLoad=function(t){var e=$(t.target),i={clientWidth:80,clientHeight:80};this.pipPictureUtils.setImageMarginCSS(i,e),this.control.uploading=!1},o.prototype.onChange=function(){this.pipChanged&&this.pipChanged({$event:{sender:this.control},$control:this.control})},o)};function o(t,e,i,r,n,o,l,a){var c=this;this.$log=t,this.$scope=e,this.$rootScope=i,this.$element=r,this.pipPictureData=n,this.pipPictureUtils=o,this.$timeout=l,this.pipFileUpload=a,this.pipPicturePaste=new u.PicturePaste(l),this.pictureStartState=this.pipAddedPicture?p.Copied:p.Original,this.text=this.text||"PICTURE_EDIT_TEXT",this.icon=this.icon||"picture-no-border",this.errorText="PICTURE_ERROR_LOAD",this.multiUpload=!1,this.control=new s,this.control.state=this.pictureStartState,this.control.reset=function(t){c.resetImage(t)},this.control.save=function(t,e){c.saveImage(t,e)},this.control.abort=function(){c.abort()},r.addClass("pip-picture-edit")}angular.module("pipPictureEdit",["ui.event","pipPicturePaste","pipTranslate","angularFileUpload","pipPictures.Templates"]).config(r).component("pipPictureEdit",n)},{"../utilities/PicturePaste":43}],33:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t("../utilities/PicturePaste"),a=t("async"),o=function(){};i.PictureListEditItem=o;var p=function(){this.uploading=0};i.PictureListEditControl=p;var d=function(){};d.Added="added",d.Original="original",d.Copied="copied",d.Changed="changed",d.Deleted="deleted",d.Error="error",i.PictureListEditStates=d;function r(){}i.PictureUploadErrors=r;function n(t){t.translations("en",{PICTURE_LIST_EDIT_TEXT:"Click here to add a picture",ERROR_TRANSACTION_IN_PROGRESS:"Transaction is in progress. Please, wait until it is finished or abort",ERROR_IMAGE_PRELOADING:"Image loading error. The picture can not be saved"}),t.translations("ru",{PICTURE_LIST_EDIT_TEXT:"Нажмите сюда чтобы добавить картинку",ERROR_TRANSACTION_IN_PROGRESS:"Транзакция еще не завершена. Подождите окончания или прервите её",ERROR_IMAGE_PRELOADING:"Ошибка при загрузки картинки. Картинка не сохранена."})}n.$inject=["pipTranslateProvider"];var l={bindings:{ngDisabled:"<?",pipCreated:"&?",pipChanged:"&?",pictures:"=?pipPictures",pipAddedPicture:"&?",text:"<?pipDefaultText",icon:"<?pipDefaultIcon",pipRebind:"<?"},templateUrl:"picture_list_edit/PictureListEdit.html",controller:(c.$inject=["$log","$scope","$rootScope","$element","pipPictureUtils","$timeout","pipFileUpload","pipRest","pipPictureData"],c.prototype.toBoolean=function(t){return null!=t&&!!t&&("1"==(t=t.toString().toLowerCase())||"true"==t)},c.prototype.filterItem=function(t){return t.state!=d.Deleted},c.prototype.$postLink=function(){this.controlElement=this.$element.find(".pip-picture-drop"),this.control.reset(),this.pipCreated&&this.pipCreated({$event:{sender:this.control},$control:this.control})},c.prototype.removeItem=function(t){if(t.state===d.Added||t.state===d.Copied){var e=_.findIndex(this.control.items,{pin:t.pin});-1<e&&this.control.items.splice(e,1)}else t.state=d.Deleted},c.prototype.$onChanges=function(t){t.pipRebind&&t.pipRebind.currentValue!==t.pipRebind.previousValue&&(this.pipRebind=t.pipRebind.currentValue),t.ngDisabled&&t.ngDisabled.currentValue!==t.ngDisabled.previousValue&&(this.ngDisabled=t.ngDisabled.currentValue),this.pipRebind&&t.pictures&&!_.isEqual(t.pictures.currentValue,this.pictures)&&(this.pictures=t.pictures.currentValue,this.control.reset()),this.pictures=this.pictures?this.pictures:[]},c.prototype.onImageError=function(t,e){e.state=d.Error,e.url=""},c.prototype.onFocus=function(){var e=this;this.pipPicturePaste.addPasteListener(function(t){e.readItemLocally(t.url,t.uriData,t.file,t.picture)})},c.prototype.onBlur=function(){this.pipPicturePaste.removePasteListener()},c.prototype.getItems=function(){var t,e=[];if(null==this.pictures||0==this.pictures.length)return e;for(t=0;t<this.pictures.length;t++){var i={pin:this.itemPin++,id:this.pictures[t].id,name:this.pictures[t].name,uri:this.pictures[t].uri,uriData:null,uploading:!1,uploaded:!1,progress:0,file:null,url:this.pictures[t].id?this.pipPictureData.getPictureUrl(this.pictures[t].id):this.pictures[t].uri,state:this.pictureStartState};e.push(i)}return e},c.prototype.setItems=function(){var t;for(this.pictures&&0<this.pictures.length&&this.pictures.splice(0,this.pictures.length),t=0;t<this.control.items.length;t++){var e=this.control.items[t];if((e.id||e.uri)&&e.state!=d.Deleted){var i={id:e.id,name:e.name,uri:e.uri};this.pictures.push(i)}}},c.prototype.reset=function(){this.controlElement&&(this.control.uploading=0,this.control.items=this.getItems())},c.prototype.addItem=function(t,e,i){var r=_.findIndex(this.control.items,{pin:t.pin});r<0||(i?(this.control.items[r].uploaded=!1,this.control.items[r].uploading=!1,this.control.items[r].progress=0,this.control.items[r].upload=null,this.control.items[r].state=d.Error):(e?(this.control.items[r].id=e.id,this.control.items[r].name=e.name,this.control.items[r].uploaded=!0,this.control.items[r].state=d.Original):this.control.items[r].uploaded=!1,this.control.items[r].uploading=!1,this.control.items[r].uriData=null,this.control.items[r].progress=0,this.control.items[r].upload=null,this.control.items[r].file=null))},c.prototype.deleteItem=function(t,e){t.upload&&(t.upload.abort(),t.upload=null),t.state==d.Deleted&&(this.removeItem(t),e())},c.prototype.save=function(r,n){var o=this;if(this.control.uploading)n&&n("ERROR_TRANSACTION_IN_PROGRESS");else{this.cancelQuery=null,this.control.error=null,this.control.uploading=0;var l=[],e=[];_.each(this.control.items,function(t){"added"==t.state&&(t.file?l.push(t):e.push(t))});var t=_.filter(this.control.items,{state:"deleted"});if(_.each(e,function(t){t.uploaded=!0,t.uploading=!1,t.progress=0,t.upload=null,t.uriData=null,t.file=null,t.state=d.Original}),!l.length&&!t.length)return 0<e.length&&this.setItems(),this.control.uploading=0,void(r&&r(this.pictures));this.control.uploading=l.length+t.length,a.parallel([function(r){_.each(l,function(t){t.uploading=!0,t.progress=0}),o.pipFileUpload.multiUpload(o.pipPictureData.postPictureUrl(),l,function(t,e,i){var r=l[t];o.addItem(r,e,i),i&&(o.control.error=!0)},function(t,e,i){l[t].progress=i},function(t,e,i){o.cancelQuery=null,r()},function(t){o.cancelQuery=t},!1,"pin")},function(i){t.length?a.each(t,function(t,e){o.deleteItem(t,function(t){e()})},function(t,e){i()}):i()}],function(t,e){if(t&&!o.control.error&&(o.control.error=t),o.control.error){o.control.uploading=0;var i=o.getUploadErors();n?n(i):o.$log.error(i)}else o.setItems(),o.control.uploading=0,r&&r(o.pictures)})}},c.prototype.getUploadErors=function(){var e=[];return _.each(this.control.items,function(t){t.state!=d.Error&&t.state!=d.Error||e.push({id:t.id,uri:t.uri,name:t.name})}),e},c.prototype.abort=function(){var t;for(t=0;t<this.control.items.length;t++){var e=this.control.items[t];e.uploading&&(e.upload&&e.upload.abort(),e.uploaded=!1,e.uploading=!1,e.progress=0,e.upload=null)}this.cancelQuery&&this.cancelQuery.resolve(),this.control.uploading=0,this.control.error=!0},c.prototype.readItemLocally=function(t,e,i,r){var n=new o;n.pin=this.itemPin++,n.uploading=!1,n.uploaded=!1,n.progress=0,r?(n.file=null,n.name=r.name,n.uri=r.uri,n.id=r.id,n.uriData=null,n.url=r.uri?r.uri:r.id?this.pipPictureData.getPictureUrl(r.id):"",n.state,d.Copied):(n.file=i,n.name=i?i.name:t?t.split("/").pop():null,n.url=!i&&t?t:e||"",n.uri=!i&&t?t:null,n.uriData=e,n.id=null,n.state=d.Added),this.control.items.push(n),this.onChange()},c.prototype.onSelectClick=function(t){var e;if(this.controlElement.focus(),null!=t&&0!=t.length)for(e=0;e<t.length;e++){var i=t[e];-1<i.type.indexOf("image")&&this.readItemLocally("",null,i,null)}},c.prototype.onDeleteClick=function(t){this.removeItem(t),this.onChange()},c.prototype.onKeyDown=function(t,e){var i=this;e?46!=t.keyCode&&8!=t.keyCode||(e.state==d.Added?this.removeItem(e):e.state=d.Deleted,this.onChange()):13!=t.keyCode&&32!=t.keyCode||setTimeout(function(){i.controlElement.trigger("click")},0)},c.prototype.onImageLoad=function(i,t){var r=this;setTimeout(function(){var t=$(i.target),e={clientWidth:80,clientHeight:80};r.pipPictureUtils.setImageMarginCSS(e,t)},250),t.loaded=!0},c.prototype.onChange=function(){this.pipChanged&&this.pipChanged({$event:{sender:this.control},$control:this.control})},c)};function c(t,e,i,r,n,o,l,a,c){var u=this;this.$log=t,this.$scope=e,this.$rootScope=i,this.$element=r,this.pipPictureUtils=n,this.$timeout=o,this.pipFileUpload=l,this.pipRest=a,this.pipPictureData=c,this.itemPin=0,this.pipPicturePaste=new s.PicturePaste(o),this.pictureStartState=this.toBoolean(this.pipAddedPicture)?d.Copied:d.Original,this.text=this.text||"PICTURE_LIST_EDIT_TEXT",this.icon=this.icon||"picture-no-border",this.errorText="PICTURE_ERROR_LOAD",this.control=new p,this.control.uploading=0,this.control.items=[],this.control.reset=function(){u.reset()},this.control.save=function(t,e){u.save(t,e)},this.control.abort=function(){u.abort()},r.addClass("pip-picture-list-edit")}angular.module("pipPictureListEdit",["ui.event","pipPicturePaste","pipFocused","angularFileUpload","pipPictures.Templates"]).config(n).component("pipPictureListEdit",l)},{"../utilities/PicturePaste":43,async:1}],34:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},{}],35:[function(t,e,i){function r(t){t.translations("en",{PICTURE_FROM_WEBLINK:"Add from web link",LINK_PICTURE:"Link to the picture..."}),t.translations("ru",{PICTURE_FROM_WEBLINK:"Добавить из веб ссылки",LINK_PICTURE:"Ссылка на изображение..."})}r.$inject=["pipTranslateProvider"];var n=(o.$inject=["$log","$scope","$mdDialog","$rootScope","$timeout","$mdMenu","pipPictureUtils"],o.prototype.setImageSize=function(t){var e=t.width(),i={};t.height()<e?(i.width="250px",i.height="auto"):(i.width="auto",i.height="250px"),t.css(i)},o.prototype.checkUrl=function(){var e=this,i=$("img#url_image").on("error",function(){e.invalid=!0,e.$scope.$apply()}).on("load",function(t){e.invalid=!1,e.setImageSize(i),e.$scope.$apply()}).attr("src",this.url)},o.prototype.onCancelClick=function(){this.$mdDialog.cancel()},o.prototype.onAddClick=function(){this.$mdDialog.hide(this.url)},o);function o(t,e,i,r,n,o,l){this.$log=t,this.$scope=e,this.$mdDialog=i,this.$rootScope=r,this.$timeout=n,this.$mdMenu=o,this.pipPictureUtils=l,this.url="",this.invalid=!0,this.theme=this.$rootScope[pip.themes.ThemeRootVar]}angular.module("pipPictureUrlDialog").config(r).controller("pipPictureUrlDialogController",n)},{}],36:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=(n.$inject=["$mdDialog"],n.prototype.show=function(e,t){this._mdDialog.show({templateUrl:"picture_url_dialog/PictureUrlDialog.html",clickOutsideToClose:!0,controller:"pipPictureUrlDialogController",controllerAs:"$ctrl"}).then(function(t){e&&e(t)})},n);function n(t){this._mdDialog=t}angular.module("pipPictureUrlDialog").service("pipPictureUrlDialog",r)},{}],37:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipPictureUrlDialog",["ngMaterial","pipPictures.Templates"]),t("./IPictureUrlDialogService"),t("./PictureUrlDialogService"),t("./PictureUrlDialogController")},{"./IPictureUrlDialogService":34,"./PictureUrlDialogController":35,"./PictureUrlDialogService":36}],38:[function(t,e,i){function r(t){t.registerOperation("avatars","/api/1.0/avatars/:avatar_id")}r.$inject=["pipRestProvider"],angular.module("pipPictures.Rest").config(r)},{}],39:[function(t,e,i){function r(t){t.registerPagedCollection("imagesets","/api/1.0/imagesets/:imageset_id",{imageset_id:"@imageset_id"},{page:{method:"GET",isArray:!1},update:{method:"PUT"}})}r.$inject=["pipRestProvider"],angular.module("pipPictures.Rest").config(r)},{}],40:[function(t,e,i){function r(t){t.registerPagedCollection("picture","/api/1.0/blobs/:picture_id",{blob_id:"@picture_id"},{page:{method:"GET",isArray:!1},update:{method:"PUT"}}),t.registerResource("picturesInfo","/api/1.0/blobs/:picture_id/info")}r.$inject=["pipRestProvider"],angular.module("pipPictures.Rest").config(r)},{}],41:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),angular.module("pipPictures.Rest",[]),t("./PictureResources"),t("./ImageSetResources"),t("./AvatarResources")},{"./AvatarResources":38,"./ImageSetResources":39,"./PictureResources":40}],42:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});function r(){}i.imageCssParams=r},{}],43:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=(n.$inject=["$timeout"],n.prototype.addPasteListener=function(r){var n=this;window.Clipboard||(null!==this.pasteCatcher&&void 0!==this.pasteCatcher&&this.removePasteListener(),this.pasteCatcher=document.createElement("div"),this.pasteCatcher.setAttribute("contenteditable","true"),$(this.pasteCatcher).css({position:"absolute",left:"-999",width:"0",height:"0",overflow:"hidden",outline:0}),document.body.appendChild(this.pasteCatcher)),$(document).on("paste",function(t){var e;if((e=null==t.clipboardData&&t.originalEvent?t.originalEvent:t).clipboardData){var i=e.clipboardData.items;_.each(i,function(t){if(-1!=t.type.indexOf("image")){var e=t.getAsFile(),i=new FileReader;i.onload=function(t){n.$timeout(function(){r({url:t.target.result,file:e})})},i.readAsDataURL(e)}})}else window.clipboardData&&window.clipboardData.files&&_.each(window.clipboardData.files,function(e){var t=new FileReader;t.onload=function(t){n.$timeout(function(){r({url:t.target.result,file:e})})},t.readAsDataURL(e)})})},n.prototype.removePasteListener=function(){window.Clipboard||null!==this.pasteCatcher&&void 0!==this.pasteCatcher&&(document.body.removeChild(this.pasteCatcher),this.pasteCatcher=null),$(document).off("paste")},n);function n(t){this.$timeout=t}i.PicturePaste=r,angular.module("pipPicturePaste",[])},{}],44:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=[[{flex:100,fullWidth:!0,fullHeight:!0}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{flex:50,fullHeight:!0,leftPadding:!0}]}],[{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullHeight:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0,rightPadding:!0},{flex:33,fullHeight:!0,leftPadding:!0}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:70,fullHeight:!0,rightPadding:!0},{group:!0,layout:"column",flex:30,fullHeight:!0,children:[{flex:50,leftPadding:!0,bottomPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,rightPadding:!0,topPadding:!0},{flex:50,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:30,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:70,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:50,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:100,fullWidth:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:67,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:50,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"column",flex:100,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:50,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]},{group:!0,layout:"row",flex:100,fullHeight:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0},{group:!0,layout:"column",flex:75,fullHeight:!0,children:[{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullHeight:!0,children:[{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:33,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]}],[{group:!0,layout:"column",flex:100,fullHeight:!0,fullWidth:!0,children:[{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,bottomPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,bottomPadding:!0}]},{group:!0,layout:"row",flex:50,fullWidth:!0,children:[{flex:25,fullWidth:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,rightPadding:!0,topPadding:!0},{flex:25,fullWidth:!0,leftPadding:!0,topPadding:!0}]}]}]],n=(o.prototype.getCollageSchemes=function(){return r},o.prototype.setErrorImageCSS=function(t,e){var i={width:"","margin-left":"",height:"","margin-top":""};e&&(i=_.assign(i,e)),t&&t.css(i)},o.prototype.setImageMarginCSS=function(t,e,i){var r=t.width?t.width():t.clientWidth,n=t.height?t.height():t.clientHeight,o=e[0].naturalWidth||e.width,l=e[0].naturalHeight||e.height,a=0,c={};l/n<o/r?(a=-(o/l*n-r)/2,c["margin-left"]=a+"px",c.height=n+"px",c.width=o*n/l+"px",c["margin-top"]=""):(a=-(l/o*r-n)/2,c["margin-top"]=a+"px",c.height=l*r/o+"px",c.width=r+"px",c["margin-left"]=""),i&&(c=_.assign(c,i)),e.css(c)},o.prototype.setIconMarginCSS=function(t,e){var i=t.clientWidth?t.clientWidth:t.width,r=t.clientHeight?t.clientHeight:t.height,n=0,o=r<i?r:i,l={width:o+"px","margin-left":"",height:o+"px","margin-top":""};r<i?(n=(i-r)/2,l["margin-left"]=n+"px"):(n=(r-i)/2,l["margin-top"]=n+"px"),e.css(l)},o);function o(){}var l=(a.prototype.$get=function(){return null==this._service&&(this._service=new n),this._service},a);function a(){}angular.module("pipPictureUtils",[]).provider("pipPictureUtils",l)},{}],45:[function(t,e,i){"use strict";function r(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}Object.defineProperty(i,"__esModule",{value:!0}),t("./IPictureUtils"),t("./PictureUtils"),t("./PicturePaste"),r(t("./IPictureUtils")),r(t("./PicturePaste"))},{"./IPictureUtils":42,"./PicturePaste":43,"./PictureUtils":44}],46:[function(t,e,i){!function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("add_image/AddImage.html",'<md-menu><ng-transclude class="pip-add-image-open-button" ng-click="vm.openMenu($mdOpenMenu)" xxxng-click="vm.ngDisabled() ? \'\' : $mdOpenMenu()"></ng-transclude><md-menu-content width="4"><md-menu-item ng-if="vm.option.Upload"><md-button class="layout-row layout-align-start-center" accept="image/*" ng-keydown="vm.onKeyDown($event)" ng-multiple="vm.isMulti()" ng-file-select="" ng-file-change="vm.onFileChange($files)" ng-click="vm.hideMenu()" ng-file-drop=""><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:folder"></md-icon><span class="text-grey">{{ ::\'FILE\' | translate }}</span></md-button></md-menu-item><md-menu-item ng-if="vm.option.WebLink"><md-button class="layout-row layout-align-start-center" ng-click="vm.onWebLinkClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:weblink"></md-icon><span class="text-grey">{{ ::\'WEB_LINK\' | translate }}</span></md-button></md-menu-item><md-menu-item ng-if="vm.option.Camera"><md-button class="layout-row layout-align-start-center" ng-click="vm.onCameraClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:camera"></md-icon><span class="text-grey">{{ ::\'CAMERA\' | translate }}</span></md-button></md-menu-item><md-menu-item ng-if="vm.option.Galery"><md-button class="layout-row layout-align-start-center" ng-click="vm.onGalleryClick()"><md-icon class="text-headline text-grey rm24-flex" md-svg-icon="icons:images"></md-icon><span class="text-grey">{{ ::\'IMAGE_GALLERY\' | translate }}</span></md-button></md-menu-item></md-menu-content></md-menu>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("camera_dialog/CameraDialog.html",'<md-dialog class="pip-dialog pip-picture-dialog pip-camera-dialog layout-column" md-theme="{{$ctrl.theme}}" ng-show="$ctrl.browser != \'android\'" ng-class="{\'pip-android-dialog\': $ctrl.browser == \'android\' || !$ctrl.browser}"><div class="pip-header"><md-button ng-click="$ctrl.onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="m0 text-title">{{ ::\'TAKE_PICTURE\' | translate }}</h3></div><div class="pip-body"><div class="camera-stream" ng-hide="$ctrl.webCamError || $ctrl.browser == \'android\'"></div><div class="camera-error" ng-show="$ctrl.webCamError || $ctrl.browser == \'android\'"><span>{{ ::\'WEB_CAM_ERROR\' | translate }}</span></div></div><div class="pip-footer"><div class="w48"><md-button ng-click="$ctrl.onResetPicture()" ng-hide="!$ctrl.freeze || $ctrl.webCamError" class="md-icon-button" ng-disabled="transaction.busy()" aria-label="{{ ::\'REMOVE_PICTURE\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:refresh"></md-icon></md-button></div><div class="flex"></div><div class="w48"><md-button ng-click="$ctrl.onTakePictureClick()" ng-hide="$ctrl.webCamError" class="md-icon-button" aria-label="{{ ::\'TAKE_PICTURE\' | translate }}"><md-icon class="text-grey icon-button" md-svg-icon="icons:{{$ctrl.freeze ? \'check\' : \'camera\'}}"></md-icon></md-button></div><div class="flex"></div><div class="w48"><md-button ng-click="$ctrl.onCancelClick()" class="md-icon-button" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:cross"></md-icon></md-button></div></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("gallery_search_dialog/GallerySearchDialog.html",'<md-dialog class="pip-dialog pip-gallery-search-dialog pip-picture-dialog layout-column" md-theme="{{ $ctrl.theme }}"><md-progress-linear ng-show="$ctrl.transaction.busy()" md-mode="indeterminate"></md-progress-linear><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll flex layout-row"><div class="layout-column layout-align-start-start flex"><div class="pip-header w-stretch layout-column layout-align-start-start"><h3 class="w-stretch text-title m0 bp8"><md-button class="md-icon-button m0" ng-click="$ctrl.onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button>{{ ::\'IMAGE_GALLERY\' | translate }}</h3><div class="w-stretch divider-bottom layout-row layout-start-center"><input class="no-divider rm8 text-subhead1 flex" ng-disabled="$ctrl.transaction.busy()" ng-model="$ctrl.search" ng-keypress="$ctrl.onKeyPress($event)" placeholder="{{ ::\'SEARCH_PICTURES\' | translate }}" type="text" tabindex="1"><md-button class="md-icon-button md-icon-button-square p0 pip-search-button md-primary" ng-click="$ctrl.onSearchClick()" ng-hide="$ctrl.optionDefault" tabindex="-1" aria-label="SEARCH"><md-icon class="text-opacity md-primary" md-svg-icon="icons:search-square"></md-icon></md-button></div></div><div class="pip-content flex" ng-show="$ctrl.imagesSearchResult.length > 0"><div class="pip-image-container" ng-click="$ctrl.onImageClick(image)" ng-repeat="image in $ctrl.imagesSearchResult track by $index" ng-class="{\'checked\': image.checked}" tabindex="{{ $index + 2 }}"><pip-picture pip-src="image.thumbnail" pip-default-icon="icon-images" pip-rebind="true"></pip-picture><div class="pip-checked-cover"></div><div class="pip-checkbox-backdrop"><md-checkbox md-no-ink="" ng-model="image.checked" ng-click="image.checked = !image.checked" aria-label="CHECKED"></md-checkbox></div></div></div><div class="pip-no-images w-stretch layout-column layout-align-center-center flex" ng-show="$ctrl.imagesSearchResult.length == 0"><img src="images/add_from_image_library.svg" width="200" height="200"><p class="text-secondary opacity-secondary text-center">{{ ::\'IMAGE_START_SEARCH\' | translate }}</p></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="$ctrl.onCancelClick()" ng-hide="$ctrl.transaction.busy()" aria-label="{{ ::\'CANCEL\' | translate }}" tabindex="{{ $ctrl.imagesSearchResult.length + 3 }}"><span class="text-grey">{{ ::\'CANCEL\' | translate }}</span></md-button><md-button ng-if="transaction.busy()" ng-click="$ctrl.onStopSearchClick()" class="md-raised md-warn m0" tabindex="5" aria-label="ABORT" pip-test="button-cancel">{{ ::\'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-hide="$ctrl.transaction.busy()" ng-disabled="$ctrl.addButtonDisabled()" ng-click="$ctrl.onAddClick()" aria-label="{{ ::\'ADD\' | translate }}" tabindex="{{ $ctrl.imagesSearchResult.length + 4 }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("picture_edit/PictureEdit.html",'<div class="pip-picture-upload pip-picture-drop md-focused" ng-keydown="$ctrl.onKeyDown($event)" ng-class="{\'pip-picture-error\': $ctrl.control.state == \'error\'}" tabindex="{{ $ctrl.ngDisabled || $ctrl.control.uploading ? -1 : 0 }}" pip-changed="$ctrl.readItemLocally(url, uriData, file, picture)" ng-disabled="$ctrl.ngDisabled" pip-multi="$ctrl.multiUpload" ng-focus="$ctrl.onFocus()" ng-blur="$ctrl.onBlur()" pip-option="$ctrl.option" pip-add-image=""><div class="pip-default-icon" ng-show="$ctrl.empty() || $ctrl.control.state == \'error\'"><md-icon class="pip-picture-icon" md-svg-icon="icons:{{ $ctrl.icon }}"></md-icon></div><div class="pip-default-text" ng-show="$ctrl.control.state == \'error\'"><span>{{ $ctrl.errorText | translate }}</span></div><div class="pip-default-text" ng-show="$ctrl.empty() && $ctrl.control.state != \'error\'"><span>{{ $ctrl.text | translate }}</span></div><img class="pip-picture-image" ng-src="{{ $ctrl.control.url }}" ng-show="!$ctrl.empty() && $ctrl.control.state != \'error\'" ng-class="{ \'pip-image-new\': $ctrl.isUpdated(), \'cursor-default\' : $ctrl.ngDisabled || $ctrl.control.uploading }" ui-event="{ error: \'$ctrl.onImageError($event)\', load: \'$ctrl.onImageLoad($event)\' }"><md-button class="md-icon-button" ng-click="$ctrl.onDeleteClick($event)" tabindex="-1" aria-label="delete" ng-hide="$ctrl.empty() || $ctrl.ngDisabled" ng-disabled="$ctrl.ngDisabled || $ctrl.control.uploading"><md-icon md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear ng-show="$ctrl.control.uploading" ng-value="$ctrl.control.progress"></md-progress-linear></div>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("picture_list_edit/PictureListEdit.html",'<div pip-focused=""><div class="pip-picture-upload pointer pip-focusable" ng-class="{\'pip-picture-error\': item.state == \'error\'}" ng-keydown="$ctrl.onKeyDown($event, item)" tabindex="{{ $ctrl.ngDisabled ? -1 : 0 }}" ng-repeat="item in $ctrl.control.items | filter: $ctrl.filterItem"><div class="pip-default-icon" ng-hide="item.loaded || item.state == \'error\'"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{ $ctrl.icon }}"></md-icon></div><div class="pip-default-text" ng-show="$ctrl.control.state == \'error\'"><span>{{ $ctrl.errorText | translate }}</span></div><img ng-src="{{ ::item.url }}" pip-cancel-drag="true" ng-hide="item.state == \'error\'" ng-class="{ \'pip-image-new\': item.state == \'added\' }" ui-event="{ error: \'$ctrl.onImageError($event, item)\', load: \'$ctrl.onImageLoad($event, item)\' }"><md-button ng-click="$ctrl.onDeleteClick(item)" ng-hide="$ctrl.ngDisabled || $ctrl.control.uploading" ng-disabled="$ctrl.ngDisabled || $ctrl.control.uploading" tabindex="-1" aria-label="delete" class="md-icon-button"><md-icon pip-cancel-drag="true" md-svg-icon="icons:cross"></md-icon></md-button><md-progress-linear md-mode="indeterminate" ng-show="item.uploading" value="{{ item.progress }}"></md-progress-linear></div><button class="pip-picture-upload pip-picture-drop pip-focusable" pip-add-image="" pip-multi="true" ng-focus="$ctrl.onFocus()" ng-blur="$ctrl.onBlur()" pip-changed="$ctrl.readItemLocally(url, uriData, file, picture)" ng-disabled="$ctrl.ngDisabled || $ctrl.control.uploading"><div class="pip-default-icon"><md-icon pip-cancel-drag="true" class="pip-picture-icon" md-svg-icon="icons:{{ $ctrl.icon }}"></md-icon></div><div class="pip-default-text"><span>{{ $ctrl.text | translate }}</span></div></button><div class="clearfix"></div></div>')}])}(),function(e){try{e=angular.module("pipPictures.Templates")}catch(t){e=angular.module("pipPictures.Templates",[])}e.run(["$templateCache",function(t){t.put("picture_url_dialog/PictureUrlDialog.html",'<md-dialog class="pip-dialog pip-picture-url-dialog pip-picture-dialog layout-column" md-theme="{{ $ctrl.theme }}"><md-dialog-content class="pip-body lp0 rp0 tp0 pip-scroll"><div class="pip-header bm16 layout-row layout-align-start-center"><md-button ng-click="$ctrl.onCancelClick()" class="md-icon-button lm0" aria-label="{{ ::\'CANCEL\' | translate }}"><md-icon class="text-grey" md-svg-icon="icons:arrow-left"></md-icon></md-button><h3 class="text-title m0">{{ ::\'PICTURE_FROM_WEBLINK\' | translate}}</h3></div><div class="pip-content lm6 rm16"><md-input-container md-no-float="" class="w-stretch text-subhead1"><input type="text" ng-model="$ctrl.url" ng-change="$ctrl.checkUrl()" placeholder="{{ ::\'LINK_PICTURE\' | translate }}"></md-input-container><div class="w-stretch layout-row layout-align-center-center" ng-hide="$ctrl.invalid"><img id="url_image"></div><div class="pip-no-images layout-row layout-align-center-center" ng-show="$ctrl.invalid"><md-icon class="text-grey" md-svg-icon="icons:images"></md-icon></div></div></md-dialog-content><div class="pip-footer"><md-button ng-click="$ctrl.onCancelClick()" aria-label="{{ ::\'CANCEL\' | translate }}">{{ ::\'CANCEL\' | translate }}</md-button><md-button class="md-accent" ng-click="$ctrl.onAddClick()" ng-disabled="$ctrl.invalid" aria-label="{{ ::\'ADD\' | translate }}">{{ ::\'ADD\' | translate }}</md-button></div></md-dialog>')}])}()},{}]},{},[46,30])(46)});
//# sourceMappingURL=pip-suite-pictures.min.js.map
